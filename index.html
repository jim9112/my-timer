<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Jimmy's Time Keeper</title>

  </head>
  <body>
    
    <!-- <div>
      <span>Hours:</span><span id="hours">00</span><span>Minutes</span><span id="minutes">00</span><span>Seconds</span><span id="seconds">00</span>
    </div> -->
    <div x-data="{
      dayStart: 0,
      lastBlock: 0,
      dayStarted: false,
      todaysBlocks: [],
      startDay() {
        this.dayStart = Date.now();
        this.dayStarted = true;
        console.log(this.dayStart);
      },
      recordBlock() {
        let endTime = Date.now();
        let startTime = this.lastBlock !== 0 ? this.lastBlock : this.dayStart;
        this.todaysBlocks.push({
          title: 'Block ' + (parseInt(this.todaysBlocks.length) + parseInt(1)),
          start: startTime,
          end: endTime,
          totalseconds: Math.round((endTime - startTime) / 1000),
        });
        this.lastBlock = endTime;
        console.log(this.todaysBlocks);
      },
      outputTime(timeElapsed) {
        console.log(timeElapsed);
        return new Date(timeElapsed * 1000).toISOString().substring(11, 19);
      },
    }" class="h-screen flex flex-col px-4 pt-5">
    <h1 class="text-3xl font-bold">Record Your Time</h1>
      <button x-show="dayStarted === false" x-on:click="startDay()" class="border-2 border-black rounded-md px-1 py-1" type="button">Start Day</button>
      <button x-show="dayStarted === true" x-on:click="recordBlock()" class="border-2 border-black rounded-md px-1 py-1" type="button">Record Block</button>
      <ul class="flex-1 overflow-y-scroll">
        <template x-for="(block, index) in todaysBlocks">
          <li class="border-b-2 border-black" x-data="{ edit: false }">
            <div>
              <button x-on:click="edit = true" class="border-2 border-black rounded-md px-1 py-1" type="button">Edit</button><span x-text="block.title + ' ' + outputTime(block.totalseconds)"></span>
            </div>
            <div x-show="edit === true"><button class="border-2 border-black rounded-md px-1 py-1" type="button" x-on:click="edit = false">Save</button><input @keyup.enter="edit = false" type="text" name="block label" x-model="block.title"></div>
          </li>
        </template>
      </ul>
      <div class="flex justify-evenly pb-3">
        <button class="border-2 border-black rounded-md px-1 py-1" type="button">Finish My Day</button>
        <button class="border-2 border-black rounded-md px-1 py-1" type="button">Reset My Day</button>
        <button class="border-2 border-black rounded-md px-1 py-1" type="button">Take a Break</button>
      </div>
    </div>
    <script type="module" src="/src/renderer.ts"></script>
  </body>
</html>
